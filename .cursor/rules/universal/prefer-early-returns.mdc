---
name: prefer-early-returns
description: AI generates deeply nested if-else chains instead of early return patterns
category: universal
severity: warning
---

# Prefer Early Returns

## ğŸ¯ Rule Purpose

**Eliminates deeply nested if-else chains by enforcing early return patterns.**

This rule detects "pyramid of doom" nested conditions and forces the use of guard clauses and early returns for cleaner, more readable code.

## ğŸš« AI Limitation Resolved

**Problem**: AI creates deeply nested if-else chains because:
- Training data shows "check everything first" patterns
- Nested conditions seem logical in isolation
- Happy path logic gets buried deep inside
- Error handling is mixed with business logic

**Solution**: This state machine detects nesting patterns and enforces guard clause patterns.

## âš¡ How It Works

1. **Detection**: Scans for nested if-else chains deeper than 2 levels
2. **Analysis**: Evaluates if early returns can flatten the structure
3. **Constraint**: Forces guard clause patterns with early returns
4. **Validation**: Ensures maximum nesting depth and clear flow

## ğŸ’¡ Key Constraints Applied

- **Max Nesting**: 2 levels maximum for any function
- **Guard Clauses**: Error conditions first with early returns
- **Happy Path Last**: Main logic at top level, not buried
- **Fail Fast**: Validate inputs immediately
- **Clear Flow**: Obvious error conditions and success path

## ğŸ¯ Expected Results

After applying this rule, your AI will generate:
- âœ… Guard clauses for input validation
- âœ… Early returns for error conditions  
- âœ… Happy path logic at top level
- âœ… Maximum 2 levels of nesting
- âœ… Clear, readable function flow
- âŒ No pyramid of doom structures
- âŒ No deeply buried logic
- âŒ No complex nested conditions